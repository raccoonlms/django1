<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理界面</title>
{% load static %}
    <style>
        /* 全局样式设置 */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: stretch;
            height: 100vh;
        }
 /* 添加Logo定位样式 */
        .logo {
            position: absolute;
            bottom: 0px;
           right: 0px;
            width: 220px;

        }

        /* 工具栏样式 */
        .toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            border-bottom: 1px solid #ccc;
        }

        .toolbar .left-section {
            display: flex;
            align-items: center;
        }

        .toolbar input[type="text"] {
            padding: 5px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .toolbar button {
            padding: 5px 10px;
            margin-left: 5px;
            border: none;
           background-image: linear-gradient(to top, #00c6fb 0%, #005bea 100%);
            color: white;
            border-radius: 3px;
            cursor: pointer;
        }

        .toolbar button:hover {
            background-color: #0056b3;
        }

        /* 按钮栏样式 */
        .button-bar {
            display: flex;
            justify-content: flex-start;
            padding: 10px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #ccc;
        }

        .button-bar button {
            padding: 10px 20px;
            margin-right: 10px;
            border: none;
            background-image: linear-gradient(to top, #00c6fb 0%, #005bea 100%);
            color: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 16px;
        }

        .button-bar button:hover {
            background-color: #0056b3;
        }

        /* 主要内容区域样式 */
        .main-content {
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
	background-image: linear-gradient(to top, #a8edea 0%, #fed6e3 100%);
        }

        /* 输入栏样式 */
        .input-row {
            display: flex;
            margin-bottom: 10px;
        }

        .input-row label {
            width: 100px;
            margin-right: 10px;
        }

        .input-row input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        /* 按钮组样式 */
        .buttons {
            margin-bottom: 10px;
        }

        /* 表格样式 */
        .table {
            width: 100%;
            border-collapse: collapse;
background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);
        }

        .table th, .table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }

        .table th {
            background-color: #f2f2f2;
        }	.pagination {
            display: flex;
            justify-content: center;
            padding: 10px;
        }

        .pagination a, .pagination span {
            padding: 5px 10px;
            margin: 0 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-decoration: none;
            color: #007bff;
        }

        .pagination .current-page {
            background-color: #007bff;
            color: white;
        }

        .pagination a:hover {
            background-color: #0056b3;
            color: white;
        }

        .pagination .disabled {
            color: #ccc;
            pointer-events: none;
        }

        .checkbox-column {
            text-align: center;
        }
    </style>
</head>


<body>
    <!-- 工具栏 -->
    <div class="toolbar">
        <div class="left-section">
            <a>管理员</a>
            <a href="{% url 'logout' %}" class="register-btn"><button>退出登录</button></a>
            <!--
<img src="{% static 'images/logo.png' %}" alt="Logo" class="logo">
            -->
        </div>
    </div>

    <!-- 按钮栏 -->
    <div class="button-bar">
        <a href="{% url 'admin_dashboard' %}" ><button >返回首页</button></a>
        
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content">
        <!-- 增加功能 -->
        <form method="POST" action="{% url 'add_competition' %}">
            {% csrf_token %}
            <div class="input-row">
                <label for="event_id">项目编号</label>
                <input type="text" id="event_id" name="event_id" required>
                <label for="event_name">信息</label>
                <input type="text" id="event_name" name="event_name" required>
                <label for="start-time">开始时间</label>
                <input type="datetime-local" id="start-time" name="start_time" required>
                <label for="end-time">结束时间</label>
                <input type="datetime-local" id="end-time" name="end_time" required>
            </div>
            <div class="buttons">
                <button type="submit">增加</button>
            </div>
        </form>

        <!-- 错误信息 -->
        {% if error %}
        <p style="color:red;">{{ error }}</p>
        {% endif %}
 

        <!-- 查询功能 -->
        <form method="GET" action="{% url 'query_competition' %}">
            <div class="input-row">
                <label for="event_id">项目编号</label>
                <input type="text" id="event_id" name="event_id">
                <label for="event_name">项目名称</label>
                <input type="text" id="event_name" name="event_name">
            </div>
            <div class="buttons">
                <button type="submit">查询/刷新</button>
            </div>
        </form>

        
    <!-- 表格 -->
    <form method="POST" action="{% url 'delete_selected_competitions' %}">
        {% csrf_token %}
        <table class="table">
            <thead>
                <tr>
                    <th class="checkbox-column">
                        <!-- 全选框 -->
                        <input type="checkbox" id="select-all">
                    </th>
                    <th>项目编号</th>
                    <th>信息</th>
                    <th>开始时间</th>
                    <th>结束时间</th>
                </tr>
            </thead>
            <tbody>
                {% if page_obj %}
                    {% for event in page_obj %}
                        <tr>
                            <td class="checkbox-column">
                                <!-- 每一行的勾选框 -->
                                <input type="checkbox" name="selected_events" value="{{ event.id }}">
                            </td>
                            <td>{{ event.event_id }}</td>
                            <td>{{ event.event_name }}</td>
                            <td>{{ event.start_time }}</td>
                            <td>{{ event.end_time }}</td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="5">没有数据（点击查询刷新）。</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="5">没有数据（点击查询刷新）。</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <!-- 提交按钮 -->
        <!-- 提交按钮 -->
        <div class="buttons">
            <button type="submit">删除选中项</button>
        </div>
    </form>

    <!-- 分页 -->
    <div class="pagination">
        {% if page_obj.has_previous %}
        <a href="?page=1&event_id={{ event_id }}&event_name={{ event_name }}">首页</a>
        <a href="?page={{ page_obj.previous_page_number }}&event_id={{ event_id }}&event_name={{ event_name }}">上一页</a>
        {% else %}
        <span class="disabled">首页</span>
        <span class="disabled">上一页</span>
        {% endif %}

        <span class="current-page">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}&event_id={{ event_id }}&event_name={{ event_name }}">下一页</a>
        <a href="?page={{ page_obj.paginator.num_pages }}&event_id={{ event_id }}&event_name={{ event_name }}">末页</a>
        {% else %}
        <span class="disabled">下一页</span>
        <span class="disabled">末页</span>
        {% endif %}
    </div>

    <script>
        // 全选框功能
        document.getElementById('select-all').addEventListener('change', function() {
            var checkboxes = document.querySelectorAll('input[name="selected_events"]');
            checkboxes.forEach(function(checkbox) {
                checkbox.checked = document.getElementById('select-all').checked;
            });
        });
    </script>
    </div>
</body>
</html>